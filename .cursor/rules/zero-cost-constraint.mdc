---
description: Enforce zero-cost constraint for MVP1-3; MVP4 allows AI APIs (user keys; free tiers OK)
alwaysApply: true
---

# Zero-Cost Constraint (MVP1-3); MVP4 AI APIs Allowed

## Principle
**MVP1, MVP2, MVP3:** All features must work without ANY paid services.

**MVP4 (AI Trip Agent):** This is the first phase where **AI APIs are allowed**. User supplies API keys after implementation. Free-tier usage (e.g. Google Gemini, Groq, OpenRouter free models) is acceptable. See [MVP4_AI_AGENT.md](../../MVP4_AI_AGENT.md).

---

## Approved Free Services

### ✅ Allowed
- **Vercel:** Free tier hosting (100GB bandwidth, serverless functions)
- **Nominatim:** Free geocoding (OpenStreetMap)
- **Leaflet.js:** Free map rendering library
- **OpenStreetMap:** Free map tiles
- **GitHub:** Free repository hosting
- **Static data:** Mock/hardcoded data for testing
- **Cloudflare R2:** Approved for MVP3 media uploads (in-trip chat); per-user limit 100 MB; usage visible in Profile/Settings

### ❌ Forbidden in MVP1-3
- **Google Maps API** (paid after free tier)
- **Skyscanner API** (paid)
- **Any database service** (use file storage for MVP1-3; MongoDB optional before/during MVP4)
- **Email services** (SendGrid, Mailgun)
- **SMS services** (Twilio)
- **Other cloud storage** (S3, Cloudinary) — R2 is the approved exception for MVP3 media

### ✅ Allowed in MVP4 (AI Trip Agent) only
- **AI/LLM APIs** for trip agent: user supplies API keys; free-tier providers (Gemini, Groq, OpenRouter free models, etc.) are acceptable. Paid providers (OpenAI, Anthropic) allowed when user adds key. See [MVP4_AI_AGENT.md](../../MVP4_AI_AGENT.md).

---

## Implementation Strategies

### For AI Suggestions (MVP1)
**Problem:** Need trip recommendations  
**Solution:** Pre-defined destination database

```javascript
// ✅ GOOD: Mock data
const DESTINATIONS = {
  'Paris': {
    popular: ['Eiffel Tower', 'Louvre', 'Notre Dame'],
    hidden: ['Canal Saint-Martin', 'Promenade Plantée']
  }
};

// ❌ BAD: OpenAI API
const suggestions = await openai.complete('Suggest Paris attractions');
```

### For Geocoding (MVP1-3)
**Problem:** Need lat/lng for destinations  
**Solution:** Nominatim (free OSM geocoding)

```javascript
// ✅ GOOD: Nominatim
const response = await fetch(
  `https://nominatim.openstreetmap.org/search?` +
  `q=${destination}&format=json&limit=1`
);

// ❌ BAD: Google Geocoding API
const response = await googleMaps.geocode(destination);
```

### For Map Rendering (MVP1-3)
**Problem:** Need interactive maps  
**Solution:** Leaflet.js + OpenStreetMap tiles

```jsx
// ✅ GOOD: Leaflet + OSM
<MapContainer>
  <TileLayer url="https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png" />
</MapContainer>

// ❌ BAD: Google Maps
<GoogleMap apiKey="..." />
```

### For Trip Suggestions (MVP2)
**Problem:** Need destination recommendations  
**Solution:** Web scraping or community data

```javascript
// ✅ GOOD: Scraping or curated lists
const suggestions = await scrapePopularDestinations();
// or use static JSON with top 100 cities

// ❌ BAD: Paid travel API
const suggestions = await travelAdvisorAPI.getRecommendations();
```

### For Real-time Features (MVP3)
**Problem:** Need live location, chat  
**Solution:** Browser Geolocation API + polling/WebSocket

```javascript
// ✅ GOOD: Browser API + Vercel WebSocket
navigator.geolocation.getCurrentPosition(pos => {
  const { latitude, longitude } = pos.coords;
});

// ❌ BAD: Paid location services
const location = await geoLocationService.getLocation();
```

### For Media Upload (MVP3)
**Problem:** In-trip chat needs image/media storage  
**Solution:** Cloudflare R2 (approved), with user-level limits and visibility

- **Storage:** Cloudflare R2 for media uploads.
- **Per-user limit:** 100 MB per user (enforced server-side).
- **Visibility:** Show usage (e.g. "X MB / 100 MB") in Profile or Settings.
- Implement as MVP3 tasks progress.

---

## Verification Checklist

Before implementing ANY feature, verify:

- [ ] Does it require an API key?
- [ ] Does it have usage limits that require payment?
- [ ] Is there a free tier that could run out?
- [ ] Are there free alternatives?

If ANY answer is "yes" or "maybe", STOP and discuss.

---

## Cost Phase Transition

### MVP4 (AI Trip Agent)
**First phase where AI APIs are allowed:** User supplies API keys. Free-tier providers (Gemini, Groq, OpenRouter) supported; paid (OpenAI, etc.) allowed when user adds key. No change to MVP1-3 zero-cost rule.

### MVP5+ (Marketplace Integration)
**Only in MVP5 can we introduce paid travel/booking services:**
- Skyscanner API (transport pricing)
- Booking.com API (accommodation)
- Payment processing (Stripe)

**Requirement:** User must explicitly approve budget and services.

---

## Example Decisions

### ✅ APPROVED
- Leaflet.js for maps (free, open-source)
- Nominatim for geocoding (free, OSM)
- Static JSON for destination database
- Vercel free tier for hosting
- Browser Geolocation API
- Cloudflare R2 for MVP3 media (100 MB/user limit; usage in Profile/Settings)

### ❌ REJECTED (MVP1-3)
- Google Maps (paid after quota)
- Firebase (paid features needed)
- Auth0 (paid for features we need)
- Cloudinary (paid for storage)

### ✅ APPROVED in MVP4 only (user keys; free tiers OK)
- Google Gemini API, Groq, OpenRouter free models, Hugging Face Inference (see MVP4_AI_AGENT.md). OpenAI/Anthropic when user provides key.

---

## Exception Process

If you believe a paid service is NECESSARY:

1. ✅ Document why free alternatives won't work
2. ✅ Research exact pricing
3. ✅ Check if it fits Vercel free tier
4. ✅ Get explicit user approval
5. ❌ Do NOT proceed without approval

---

## Red Flags

These phrases should trigger immediate review:

- "API key required"
- "Free tier limited to 100 requests"
- "Credit card required"
- "Pricing starts at $X/month"
- "Enterprise plan needed"

**If you see these, STOP and verify it's approved.**
